{{- if not .Values.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "spacebar.fullname" . }}
  labels:
    {{- include "spacebar.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- if .Values.database.externalUrl }}
  DATABASE: {{ .Values.database.externalUrl | quote }}
  {{- else if and .Values.database.enabled (not .Values.database.externalUrl) }}
  # DATABASE is set from CNPG Cluster app secret via envFrom in Deployment
  {{- end }}
  {{- if eq .Values.storage.provider "s3" }}
  {{- if and .Values.storage.bucket .Values.storage.region }}
  STORAGE_BUCKET: {{ .Values.storage.bucket | quote }}
  STORAGE_REGION: {{ .Values.storage.region | quote }}
  {{- end }}
  {{- end }}
{{- end }}
